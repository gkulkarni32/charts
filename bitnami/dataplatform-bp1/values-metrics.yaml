## Global Docker image parameters
## Please, note that this will override the image parameters, including dependencies, configured to use the global value
## Current available global Docker image parameters: imageRegistry and imagePullSecrets
##
# global:
#   imageRegistry: myRegistryName
#   imagePullSecrets:
#     - myRegistryKeySecretName
#   storageClass: myStorageClass

## Add labels to all the deployed resources
##
commonLabels: {}

## Add annotations to all the deployed resources
##
commonAnnotations: {}

## Kubernetes Cluster Domain
##
clusterDomain: cluster.local

## Extra objects to deploy (value evaluated as a template)
##
extraDeploy: []


## Specifies whether RBAC resources should be created
##
rbac:
  create: true

## Specifies whether a ServiceAccount should be created
##
serviceAccount:
  create: true
  ## The name of the ServiceAccount to use.
  ## If not set and create is true, a name is generated using the fullname template
  ##
  name:

zookeeper:
  replicaCount: 3
  resources:
    # We usually recommend not to specify default resources and to leave this as a conscious
    # choice for the user. This also increases chances charts run on environments with little
    # resources, such as Minikube. If you do want to specify resources, uncomment the following
    # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
    limits: {}
    #  cpu: 250m
    #  memory: 1Gi
    requests:
      cpu: 250m
      memory: 1Gi
  affinity: 
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
          - key: app.kubernetes.io/name
            operator: In
            values:
            - zookeeper
        topologyKey: "kubernetes.io/hostname"

## Kafka Subchart parameters
##
kafka:
  enabled: true
  replicaCount: 3
  resources:
    # We usually recommend not to specify default resources and to leave this as a conscious
    # choice for the user. This also increases chances charts run on environments with little
    # resources, such as Minikube. If you do want to specify resources, uncomment the following
    # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
    limits: {} 
    #  cpu: 250m
    #  memory: 1Gi
    requests: 
      cpu: 250m
      memory: 1Gi
  affinity:
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
          - key: app.kubernetes.io/name
            operator: In
            values:
            - kafka
        topologyKey: "kubernetes.io/hostname"
    podAffinity:
      preferredDuringSchedulingIgnoredDuringExecution:
       - weight: 50
         podAffinityTerm:
           labelSelector:
             matchExpressions:
             - key: app.kubernetes.io/name
               operator: In
               values:
                 - zookeeper
           topologyKey: "kubernetes.io/hostname"  
  ## Prometheus Exporters / Metrics
  ##
  metrics:
    ## Prometheus Kafka Exporter: exposes complimentary metrics to JMX Exporter
    ##
    kafka:
      enabled: true
      ## Prometheus Kafka Exporter' resource requests and limits
      ## ref: http://kubernetes.io/docs/user-guide/compute-resources/
      ##
      resources:
        # We usually recommend not to specify default resources and to leave this as a conscious
        # choice for the user. This also increases chances charts run on environments with little
        # resources, such as Minikube. If you do want to specify resources, uncomment the following
        # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
        limits: {}
        #  cpu: 100m
        #  memory: 128Mi
        requests: 
          cpu: 100m
          memory: 128Mi
    ## Prometheus JMX Exporter: exposes the majority of Kafkas metrics
    ##
    jmx:
      enabled: true

      ## Prometheus JMX Exporter' resource requests and limits
      ## ref: http://kubernetes.io/docs/user-guide/compute-resources/
      ##
      resources:
        # We usually recommend not to specify default resources and to leave this as a conscious
        # choice for the user. This also increases chances charts run on environments with little
        # resources, such as Minikube. If you do want to specify resources, uncomment the following
        # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
        limits: {}
        #  cpu: 100m
        #  memory: 128Mi
        requests: 
          cpu: 100m
          memory: 128Mi
  zookeeper:
    enabled: false
  ## This value is only used when zookeeper.enabled is set to false
  ##
  externalZookeeper:
    ## Server or list of external zookeeper servers to use.
    ##
    servers: dp-zookeeper

## Spark Subchart parameters
##
spark:
  enabled: true
  ## Spark master specific configuration
  ##
  master:
    resources:
      # We usually recommend not to specify default resources and to leave this as a conscious
      # choice for the user. This also increases chances charts run on environments with little
      # resources, such as Minikube. If you do want to specify resources, uncomment the following
      # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
      limits: {}
      #  cpu: 250m
      #  memory: 1Gi
      requests:
        cpu: 250m
        memory: 1Gi
    affinity:
      podAntiAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchLabels:
              app.kubernetes.io/name: spark
              app.kubernetes.io/instance: dp-spark
              app.kubernetes.io/component: worker
          topologyKey: "kubernetes.io/hostname"
  ## Spark worker specific configuration
  ##
  worker:
    replicaCount: 2
    affinity: 
      podAntiAffinity:
        requiredDuringSchedulingIgnoredDuringExecution:
        - labelSelector:
            matchLabels:
              app.kubernetes.io/name: spark
              app.kubernetes.io/instance: dp-spark
              app.kubernetes.io/component: worker
          topologyKey: "kubernetes.io/hostname"
    resources:
      # We usually recommend not to specify default resources and to leave this as a conscious
      # choice for the user. This also increases chances charts run on environments with little
      # resources, such as Minikube. If you do want to specify resources, uncomment the following
      # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
      limits: {}
      #  cpu: 250m
      #  memory: 1Gi
      requests: 
        cpu: 250m
        memory: 1Gi
  ## Metrics configuration
  ##
  metrics:
    enabled: true

## Solr Subchart parameters
##
solr:
  enabled: true
  replicaCount: 2
  affinity: 
    podAntiAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchExpressions:
          - key: app.kubernetes.io/name
            operator: In
            values:
            - solr
        topologyKey: "kubernetes.io/hostname"   
  resources:
    # We usually recommend not to specify default resources and to leave this as a conscious
    # choice for the user. This also increases chances charts run on environments with little
    # resources, such as Minikube. If you do want to specify resources, uncomment the following
    # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
    limits: {}
    #  cpu: 1000m
    #  memory: 1Gi
    requests:
      cpu: 250m
      memory: 1Gi
  # Configuration for the solr prometheus exporter
  exporter:
    enabled: true  # Deploy the exporter
    affinity:
      podAffinity:
        preferredDuringSchedulingIgnoredDuringExecution:
         - weight: 50
           podAffinityTerm:
             labelSelector:
               matchExpressions:
               - key: app.kubernetes.io/name
                 operator: In
                 values:
                   - solr
             topologyKey: "kubernetes.io/hostname"     
    resources:
      # We usually recommend not to specify default resources and to leave this as a conscious
      # choice for the user. This also increases chances charts run on environments with little
      # resources, such as Minikube. If you do want to specify resources, uncomment the following
      # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
      limits: {}
      #  cpu: 1000m
      #  memory: 1Gi
      requests:
        cpu: 250m
        memory: 256Mi              
  zookeeper:
    enabled: false
  ## This value is only used when zookeeper.enabled is set to false
  ##
  externalZookeeper:
    ## Server or list of external zookeeper servers to use.
    ##
    servers: []

## Wavefront Subchart parameters
##
wavefront:
  enabled: true
  ## This is a unique name for the cluster (required)
  ## All metrics will receive a `cluster` tag with this value
  ##
  clusterName: data-platform
  ## Wavefront URL (cluster) and API Token (required)
  ##
  wavefront:
    url: $WAVEFRONT_URL
    token: $WAVEFRONT_TOKEN
    ## Name of an existing secret containing the token
    ##
    existingSecret:
  ## Wavefront Collector is responsible to get all Kubernetes metrics from your cluster.
  ## It will capture Kubernetes resources metrics available from the kubelets,
  ## as well as auto-discovery capabilities.
  ##
  collector:
  ## Rules based discovery configuration
  ## Ref: https://github.com/wavefrontHQ/wavefront-kubernetes-collector/blob/master/docs/discovery.md
  ##
    resources:
      # We usually recommend not to specify default resources and to leave this as a conscious
      # choice for the user. This also increases chances charts run on environments with little
      # resources, such as Minikube. If you do want to specify resources, uncomment the following
      # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
      limits: {}
      #  cpu: 200m
      #  memory: 256Mi
      requests: 
        cpu: 200m
        memory: 10Mi  
  discovery:
    enabled: true
    ## Whether to enable runtime discovery configurations
    ## Ref: https://github.com/wavefrontHQ/wavefront-collector-for-kubernetes/blob/master/docs/discovery.md#runtime-configurations
    ##
    enableRuntimeConfigs: true
    ## Can be used to add additional discovery rules
    ##
    ## ConfigMap with Collector Configuration
    ##
    # existingConfigmap: wavefront-collector-config
    config:
    # auto-discover a sample prometheus application
    # auto-discover kafka-exporter
    - name: kafka-discovery
      type: prometheus
      selectors:
        images:
        - '*bitnami/kafka-exporter*'
        #labels:
        #  k8s-app:
        #  - kube-dns
      port: 9308
      path: /metrics
      scheme: http
      prefix: kube.kafka.
    ## ConfigMap with Collector Configuration
    ##
    # existingConfigmap: wavefront-collector-config
    ## Wavefront Collector resource requests and limits
    ## ref: http://kubernetes.io/docs/user-guide/compute-resources/
    ##
  proxy:
    ## Wavefront Proxy resource requests and limits
    ## ref: http://kubernetes.io/docs/user-guide/compute-resources/
    ##
    resources:
      # We usually recommend not to specify default resources and to leave this as a conscious
      # choice for the user. This also increases chances charts run on environments with little
      # resources, such as Minikube. If you do want to specify resources, uncomment the following
      # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
      limits: {}
      #   cpu: 100m
      #   memory: 4Gi
      requests: 
        cpu: 100m
        memory: 1Gi
